# Preparation.
=> DBGInvoke __enable_schema_sync_service('true')

=> DBGInvoke __drop_tidb_table(default, test)
=> drop table if exists default.test

=> DBGInvoke __set_flush_threshold(1000000, 1000000)

# Data.
=> DBGInvoke __mock_tidb_table(default, test, 'a char')
=> DBGInvoke __refresh_schemas()
=> DBGInvoke __put_region(4, 0, 100, default, test)
=> DBGInvoke __raft_insert_row(default, test, 4, 50, '12.34')
=> DBGInvoke __raft_insert_row(default, test, 4, 51, '000.05')
=> DBGInvoke __raft_insert_row(default, test, 4, 52, '0x06.s3')
=> DBGInvoke __raft_insert_row(default, test, 4, 53, 's10.300')
=> DBGInvoke __raft_insert_row(default, test, 4, 54, '-123')
=> DBGInvoke __raft_insert_row(default, test, 4, 55, '2006-01')
=> DBGInvoke __raft_insert_row(default, test, 4, 56, '12.34')
=> DBGInvoke __raft_insert_row(default, test, 4, 57, '000.05')
=> DBGInvoke __raft_insert_row(default, test, 4, 58, '0x06.s3')
=> DBGInvoke __raft_insert_row(default, test, 4, 59, 's10.300')
=> DBGInvoke __raft_insert_row(default, test, 4, 61, '-null')

=> DBGInvoke dag('select count(1) from default.test group by a, cast_string_real(a)', 4, 'encode_type:chunk')
┌─count(1)─┬─a───────┬─cast_string_real(a)─┐
│        1 │ 2006-01 │                2006 │
│        1 │ -123    │                -123 │
│        2 │ 000.05  │                   0 │
│        1 │ -null   │                   0 │
│        2 │ s10.300 │                   0 │
│        2 │ 0x06.s3 │                   0 │
│        2 │ 12.34   │                   0 │
└──────────┴─────────┴─────────────────────┘


# known issue: cast_string_string('123d') = 123

# Clean up.
=> DBGInvoke __drop_tidb_table(default, test)
=> drop table if exists default.test